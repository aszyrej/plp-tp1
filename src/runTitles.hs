import System.IO
import System.Directory
import Data.List
import Tp
-- import Solucion
import System.Random

shuffle :: [a] -> IO [a]
shuffle [] = return []
shuffle xs = do setStdGen $ mkStdGen 1234
                randomPosition <- getStdRandom $ randomR (0, length xs - 1)
                let (left, (a:right)) = splitAt randomPosition xs
                fmap (a:) (shuffle (left ++ right))

procesarArchivo archivo = do
                            hndl <- openFile archivo ReadMode
                            contents <- hGetContents hndl
                            putStr $ if (length contents) > 0 then "" else ""
                            hClose hndl
                            return contents

readAll category = do
  let folder = "./" ++ category ++ "/"
  all <- getDirectoryContents folder
  let filtered =  filter (isSuffixOf ".txt") all
  let tags = (replicate (length filtered) category)
  setCurrentDirectory folder
  contents <- mapM (\x -> procesarArchivo x) filtered
  setCurrentDirectory "../"
  return $ (tags, contents)
  
titles = ["chicagoGirl: The Social Network Takes on a Dictator","1 Chance 2 Dance","17 Again","1971","2001: A Space Odyssey","300","6 Years","A 2nd Chance","A Christmas Story","A Clockwork Orange","A Field Full of Secrets","A Man Apart","A Night at the Opera","A Streetcar Named Desire","A Very Harold & Kumar Christmas","A Very Murray Christmas Original","A Year in Champagne","Advantageous","Adventureland","After Porn Ends","Aileen Wuornos: The Selling of a Serial Killer","Aileen: Life and Death of a Serial Killer","Airplane!","Aliens in the Attic","Aliens on the Moon: The Truth Exposed","Aloha","Alvin and the Chipmunks","Alvin and the Chipmunks: Chipwrecked","Alvin and the Chipmunks: The Squeakquel","American Beauty","American Experience: Butch Cassidy and the Sundance Kid","American Experience: Henry Ford","American Experience: The Amish: Shunned","American Experience: The Poisoner’s Handbook","American History X","American Masters: Althea","Anatomy of a Love Seen","Andaz Apna Apna","Anjelah Johnson: Not Fancy Original","Anthony Jeselnik: Thoughts and Prayers Original","Antz","Argo","Art & Copy","Atari: Game Over","Austin to Boston","Awake: The Life of Yogananda","Aziz Ansari Live at Madison Square Garden Original","Aziz Ansari: Buried Alive Original","Back in Time","Bad Night","Bajatey Raho","Balls Out","Batman & Robin","Batman Begins","Batman Forever","Batman Returns","Beasts of No Nation Original","Bee Movie","Before Sunrise","Being Elmo: A Puppeteer’s Journey","Bella Vita","Best of Enemies","Beverly Hills Cop","Beverly Hills Cop II","Big Momma’s House","Big Momma’s House 2","Big Mommas: Like Father, Like Son","Bigger Than T. Rex","Biggie & Tupac","Bonnie and Clyde","Born into Brothels","Bridegroom","Bunks","Call Me Lucky","Capital C","Casablanca","Case 39","Catch Me If You Can","Charlie and the Chocolate Factory","Chasing Amy","Chasing Ice","Chicken Run","Chinatown","Chittagong","Chris D’Elia: Incorrigible Original","Chris Tucker Live Original","Circle","Clash of the Titans","Clerks","Cocaine Cowboys Reloaded","Collateral","Coming to America","Contagion","Cowspiracy","Crazy, Stupid, Love","Creep","Dance-Off","Dark Shadows","Darr @ the Mall","Dawg Fight","Deeper","Delivery","Demetri Martin: Live (At the Time) Original","Democrats","DMT: The Spirit Molecule","Doubt","Dragons: Dawn of the Dragon Racers","DreamWorks Shrek the Halls","E-Team Original","Elf","Ella Enchanted","Emperor’s Ghost Army","Equilibrium","Eurotrip","Expelled","Extremely Loud and Incredibly Close","Fandry","Fantastic Mr. Fox","Fat, Sick & Nearly Dead","Fat, Sick & Nearly Dead 2","Fed Up","Ferris Bueller’s Day Off","Fight Club","Filmistaan","Finders Keepers","First Comes Love","Flushed Away","Footloose","Forrest Gump","Four Holidays","Friday","Friday After Next","From Dusk Till Dawn","From Dusk Till Dawn 2: Texas Blood Money","From Dusk Till Dawn 3: The Hangman’s Daughter","Full Metal Jacket","Further","G.I. Joe: The Rise of Cobra","Gangster Squad","Genius Party","Genius Party Beyond","Get Smart","Go Grandriders","God Loves Uganda","Going Clear: Scientology and the Prison of Belief","Gone Baby Gone","Gone with the Wind","Good Burger","Good Will Hunting","GoodFellas","Gran Torino","Gravity","Grease","Green Lantern","Gremlins","Guess Who","Hall Pass","Halo 4: Forward Unto Dawn","Happy Feet","Happy Feet Two","Harold & Kumar Escape from Guantanamo Bay","He’s Just Not That Into You","Heat","Heropanti","Higher","Hoop Dreams","Horrible Bosses","Hot Girls Wanted Original","Hot Wheels: The Skills to Thrill","How to Change the World","How to Sell a Banksy","How to Train Your Dragon","Hum Aapke Hain Koun","Hum Saath-Saath Hain","I Am Legend","I Love You, Man","I’m Brent Morin Original","If I Stay","Iliza Shlesinger: Freezing Hot Original","In Time","In Your Eyes","Inception","Indiana Jones and the Kingdom of the Crystal Skull","Indiana Jones and the Last Crusade","Indiana Jones and the Raiders of the Lost Ark","Indiana Jones and the Temple of Doom","Inshallah football","Iris","It Happened One Night","Jack the Giant Slayer","Jackass 3","Jay and Silent Bob Strike Back","Jen Kirkman: I’m Gonna Die Alone (And I Feel Fine) Original","Jesus Camp","Joe Rogan: Live","John Mulaney: The Comeback Kid Original","Josef Fritzl: Story of a Monster","Joseph: King of Dreams","Journey 2: The Mysterious Island","Journey to Le Mans","Jumper","Just My Luck","Kate & Leopold","Katt Williams Presents: Katthouse Comedy","Katt Williams: 9 Lives","Keep on Keepin’ On","Keith Richards: Under the Influence Original","Kevin Hart: Let Me Explain","Kids for Cash","Kill Bill: Vol. 1","Knight and Day","Knuckle","Kuch Kuch Hota Hai","Kung Fu Elliot","Kung Fu Panda","Kung Fu Panda 2","Kung Fu Panda: Holiday","Kurt & Courtney","L.A. Confidential","Lara Croft Tomb Raider: The Cradle of Life","Lara Croft: Tomb Raider","Last Days in Vietnam","Legend of the Guardians: The Owls of Ga’Hoole","License to Wed","Life as We Know It","Life Is Beautiful","Life’s Too Short: The Special","Little Hope Was Arson","Little Nicky","Little Witch Academia","Little Witch Academia: The Enchanted Parade","Living on One Dollar","Love and Other Drugs","Love Me","Madagascar","Madagascar 3: Europe’s Most Wanted","Madagascar: Escape 2 Africa","Maidentrip","Maine Pyar Kiya","Man of Steel","Man on Fire","Manhattan Romance","Manson Family Vacation","Marco Polo: One Hundred Eyes Original","Marmaduke","McCullin","Mean Girls 2","Meet Dave","Megamind","Mike Epps: Don’t Take It Personal Original","Mike Epps: Under Rated & Never Faded","Mind Game","Mission Blue Original","Mission: Impossible","Mission: Impossible – Ghost Protocol","Mission: Impossible II","Mission: Impossible III","Mitt Original","Mo’Nique: I Coulda Been Your Cellmate!","Monsters vs. Aliens","Monte Carlo","Morning Glory","Motivation 2: The Chris Cole Story","Mr. & Mrs. Smith","Mr. Warmth: The Don Rickles Project","My Babysitter’s a Vampire: The Movie","My Little Pony Equestria Girls: Rainbow Rocks","My Little Pony: Equestria Girls","My Own Man Original","Na Maloom Afraad","Naomi and Ely’s No Kiss List","National Lampoon’s Christmas Vacation","Navy SEALs: Their Untold Story","New Year’s Eve","Nfinity Champions League Cheerleading Event","Nights in Rodanthe","No Reservations","No Strings Attached","North by Northwest","NOVA: Ben Franklin’s Balloons","NOVA: Decoding Neanderthals","NOVA: First Air War","NOVA: First Man on the Moon","NOVA: Ground Zero Supertower","NOVA: Killer Landslides","NOVA: Megastorm Aftermath","NOVA: Mind of a Rampage Killer","NOVA: Rise of the Drones","NOVA: Rise of the Hackers","NOVA: Surviving Ebola","NOVA: Vaccines: Calling the Shots","NOVA: Why Planes Vanish","Ocean’s Eleven","Ocean’s Thirteen","Ocean’s Twelve","Old School","Once Upon a Time in the West","Over the Hedge","Pacific Rim","Pacific Warriors","Paid in Full","Pants on Fire","Paranormal Activity 2","Paranormal Activity 3","Particle Fever","Pee-wee’s Playhouse: Christmas Special","Pelican Dreams","Pentatonix: On My Way Home","Piku","Pirate’s Passage","Plot for Peace","Point and Shoot","Princess Arete","Project X","Pulp Fiction","Pumping Iron","Puss in Boots","Radio Rebel","Ralphie May: Unruly Original","Rango","Red Riding Hood","Resistance","Results","Rhymes for Young Ghouls","Richard Pryor: Icon","Robin Williams Remembered – A Pioneers of Television Special","Roman Holiday","Rubble Kings","Rumor Has It","Rush Hour 3","Russell Brand: End the Drugs War","Russell Brand: From Addiction to Recovery","Russell Peters: Notorious Original","Saving Private Ryan","Scary Movie","Scary Movie 2","Scooby-Doo","Scream","Scream 2","Scream 3","Secrets of Chatsworth","Secrets of Henry VIII’s Palace: Hampton Court","Secrets of Her Majesty’s Secret Service","Secrets of Highclere Castle","Secrets of Scotland Yard","Secrets of the Tower of London","Serendipity","Seven","Sex and the City 2","Sex and the City: The Movie","Sex: My British Job","Shahid","Shark Tale","Sharknado","Sharknado 2: The Second One","Sherlock Holmes","Sherlock Holmes: A Game of Shadows","Shrek","Shrek 2","Shrek Forever After","Shutter","Shutter Island","Sid the Science Kid: The Movie","Sin City","Sinbad: Legend of the Seven Seas","Singh Is Kinng","SlingShot","SMOSH: The Movie","Somm","Speed Racer","Spirit: Stallion of the Cimarron","Spy Kids","Spy Kids 2: The Island of Lost Dreams","Star Trek","Star Trek: First Contact","Starsky & Hutch","Staten Island Summer","Stephen Fry Live: More Fool Me","Stewart Lee: 41st Best Stand Up Ever","Street Kings","Sunset Boulevard","Super 8","Super High Me","Superman Returns","Surfwise","Swearnet Live","Swearnet: The Movie","Swingers","Team Hot Wheels: Build the Epic Race","Tell Spring Not to Come This Year","Tesla: Master of Lightning","The Amityville Horror","The Ark","The Battered Bastards of Baseball Original","The Boy in the Striped Pajamas","The Bugs Bunny Road Runner Movie","The Campaign","The Central Park Five","The Chosen","The Comedians of Comedy: The Movie","The Conjuring","The Covenant","The Culture High","The Dark Knight Rises","The Daughter of Dawn","The Dictator","The Dukes of Hazzard","The Fluffy Movie","The Ghost Army","The Girl Next Door","The Godfather","The Godfather: Part II","The Great Gatsby","The Great Raid","The Hangover","The Hangover: Part II","The Hangover: Part III","The Hunting Ground","The Internet’s Own Boy: The Story of Aaron Swartz","The Kill Team","The Kite","The Last Airbender","The Last Patrol","The Last Song","The Lesser Blessed","The Lord of the Rings: The Fellowship of the Ring","The Lord of the Rings: The Return of the King","The Lord of the Rings: The Two Towers","The Lucky One","The Maltese Falcon","The Matrix","The Matrix Reloaded","The Matrix Revolutions","The Monster of Mangatiti","The Motivation","The Nightmare","The Notebook","The One I Love","The Other One: The Long Strange Trip of Bob Weir Original","The Pill","The Polar Express","The Prince of Egypt","The Propaganda Game","The Reconstruction of William Zero","The Ridiculous 6 Original","The Road to El Dorado","The Search for General Tso","The Shawshank Redemption","The Shining","The Short Game Original","The SpongeBob SquarePants Movie","The Talented Mr. Ripley","The Terminal","The Thread","The Town","The Treasure of the Sierra Madre","The True Cost","The Wizard of Oz","The Wolfpack","The Wrecking Crew","There Will Be Blood","This Was Tomorrow","Tibetan Warrior","Tig Original","Timmy Time: Timmy’s Christmas Surprise","Timmy Time: Timmy’s Seaside Rescue","To Kill a Mockingbird","Tom Segura: Mostly Stories Original","Tommy Boy","Top Gun","Trading Places","Trailer Park Boys Live at the North Pole","Trailer Park Boys Live In F**kin’ Dublin","Trailer Park Boys: Drunk, High and Unemployed: Live In Austin Original","Trailer Park Boys: Say Goodnight to the Bad Guys","Trailer Park Boys: Xmas Special","Training Day","Transformers: Dark of the Moon","Transformers: Revenge of the Fallen","Trophy Kids","True Grit","Twinsters","Two Weeks Notice","Tyke Elephant Outlaw","Unforgiven","Unknown","Vampires Suck","Virunga Original","War of the Worlds (2005)","We Are Legion: The Story of the Hacktivists","We’re the Millers","Western","Wet Hot American Summer","What Happened, Miss Simone? Original","What Happens in Vegas","What’s Your Number?","Whitey: United States of America v. James J. Bulger","Winter on Fire: Ukraine’s Fight for Freedom Original","Wrath of the Titans","Yes Man","You Laugh But It’s True","Youngistaan","Zapped","Zeitgeist: Addendum","Zeitgeist: Moving Forward","Zeitgeist: The Movie","Zoolander"]

genres = ["Documentaries","Dramas","Comedies","Documentaries","Action & Adventure","Action & Adventure","Dramas","Children","Children","Sci-Fi & Fantasy","Documentaries","Action & Adventure","Comedies","Dramas","Comedies","Comedies","Documentaries","Dramas","Dramas","Documentaries","Documentaries","Documentaries","Satires","Children","Children","Dramas","Children","Children","Children","Dramas","Documentaries","Documentaries","Documentaries","Documentaries","Dramas","Documentaries","Dramas","Comedies","Comedies","Comedies","Children","Dramas","Documentaries","Documentaries","Documentaries","Documentaries","Comedies","Comedies","Documentaries","Comedies","Comedies","Satires","Action & Adventure","Action & Adventure","Action & Adventure","Action & Adventure","Dramas","Children","Dramas","Documentaries","Documentaries","Documentaries","Action & Adventure","Action & Adventure","Comedies","Comedies","Comedies","Children","Documentaries","Dramas","Documentaries","Documentaries","Children","Documentaries","Documentaries","Dramas","Horror Movies","Dramas","Children","Dramas","Documentaries","Children","Dramas","Dramas","Comedies","Comedies","Dramas","Monster Movies","Comedies","Documentaries","Dramas","Comedies","Action & Adventure","Documentaries","Dramas","Thrillers","Children","Comedies","Horror Movies","Documentaries","Documentaries","Documentaries","Comedies","Documentaries","Documentaries","Dramas","Children","Children","Documentaries","Children","Children","Documentaries","Action & Adventure","Comedies","Comedies","Dramas","Dramas","Children","Documentaries","Documentaries","Documentaries","Children","Comedies","Dramas","Documentaries","Documentaries","Children","Dramas","Dramas","Comedies","Comedies","Comedies","Action & Adventure","Action & Adventure","Action & Adventure","Dramas","Documentaries","Action & Adventure","Action & Adventure","Action & Adventure","Sci-Fi & Fantasy","Action & Adventure","Documentaries","Documentaries","Documentaries","Thrillers","Dramas","Children","Dramas","Dramas","Dramas","Sci-Fi & Fantasy","Comedies","Action & Adventure","Comedies","Comedies","Comedies","Action & Adventure","Children","Children","Comedies","Comedies","Action & Adventure","Action & Adventure","Documentaries","Documentaries","Comedies","Documentaries","Children","Documentaries","Documentaries","Children","Dramas","Dramas","Action & Adventure","Comedies","Comedies","Children","Comedies","Action & Adventure","Dramas","Sci-Fi & Fantasy","Action & Adventure","Action & Adventure","Action & Adventure","Action & Adventure","Documentaries","Documentaries","Comedies","Action & Adventure","Comedies","Satires","Comedies","Documentaries","Comedies","Comedies","Documentaries","Children","Children","Documentaries","Action & Adventure","Comedies","Comedies","Comedies","Documentaries","Documentaries","Documentaries","Comedies","Documentaries","Action & Adventure","Action & Adventure","Documentaries","Dramas","Documentaries","Children","Children","Children","Documentaries","Thrillers","Action & Adventure","Action & Adventure","Documentaries","Children","Comedies","Comedies","Dramas","Comedies","Documentaries","Comedies","Children","Children","Children","Dramas","Documentaries","Children","Children","Children","Documentaries","Dramas","Action & Adventure","Action & Adventure","Comedies","Dramas","Action & Adventure","Children","Documentaries","Comedies","Comedies","Children","Comedies","Comedies","Action & Adventure","Documentaries","Action & Adventure","Action & Adventure","Action & Adventure","Action & Adventure","Documentaries","Comedies","Children","Children","Comedies","Documentaries","Action & Adventure","Documentaries","Children","Children","Children","Documentaries","Action & Adventure","Dramas","Comedies","Documentaries","Comedies","Documentaries","Dramas","Comedies","Comedies","Action & Adventure","Documentaries","Documentaries","Documentaries","Documentaries","Documentaries","Documentaries","Documentaries","Documentaries","Documentaries","Documentaries","Documentaries","Documentaries","Documentaries","Action & Adventure","Action & Adventure","Action & Adventure","Comedies","Action & Adventure","Children","Monster Movies","Documentaries","Action & Adventure","Children","Horror Movies","Horror Movies","Documentaries","Comedies","Documentaries","Children","Dramas","Children","Documentaries","Documentaries","Children","Comedies","Dramas","Documentaries","Children","Children","Comedies","Children","Monster Movies","Documentaries","Comedies","Dramas","Documentaries","Documentaries","Comedies","Documentaries","Comedies","Action & Adventure","Documentaries","Documentaries","Comedies","Action & Adventure","Satires","Satires","Children","Horror Movies","Horror Movies","Horror Movies","Documentaries","Documentaries","Documentaries","Documentaries","Documentaries","Documentaries","Comedies","Thrillers","Comedies","Comedies","Documentaries","Dramas","Children","Sci-Fi & Fantasy","Sci-Fi & Fantasy","Action & Adventure","Action & Adventure","Children","Children","Children","Horror Movies","Thrillers","Children","Action & Adventure","Children","Action & Adventure","Children","Comedies","Documentaries","Children","Children","Children","Children","Action & Adventure","Action & Adventure","Action & Adventure","Comedies","Comedies","Comedies","Action & Adventure","Dramas","Action & Adventure","Documentaries","Action & Adventure","Documentaries","Comedies","Comedies","Comedies","Children","Documentaries","Documentaries","Horror Movies","Dramas","Documentaries","Dramas","Children","Comedies","Documentaries","Thrillers","Documentaries","Horror Movies","Action & Adventure","Documentaries","Action & Adventure","Dramas","Satires","Action & Adventure","Comedies","Documentaries","Comedies","Dramas","Dramas","Dramas","Action & Adventure","Comedies","Comedies","Comedies","Documentaries","Documentaries","Documentaries","Dramas","Children","Documentaries","Dramas","Dramas","Action & Adventure","Action & Adventure","Action & Adventure","Dramas","Dramas","Action & Adventure","Action & Adventure","Action & Adventure","Dramas","Documentaries","Thrillers","Dramas","Dramas","Documentaries","Dramas","Children","Children","Documentaries","Dramas","Action & Adventure","Children","Documentaries","Dramas","Thrillers","Documentaries","Children","Dramas","Dramas","Documentaries","Action & Adventure","Action & Adventure","Documentaries","Children","Documentaries","Documentaries","Dramas","Children","Documentaries","Documentaries","Children","Children","Dramas","Comedies","Comedies","Dramas","Comedies","Comedies","Comedies","Comedies","Comedies","Comedies","Dramas","Action & Adventure","Action & Adventure","Documentaries","Dramas","Documentaries","Comedies","Documentaries","Action & Adventure","Thrillers","Satires","Documentaries","Action & Adventure","Documentaries","Comedies","Documentaries","Comedies","Documentaries","Comedies","Comedies","Documentaries","Documentaries","Action & Adventure","Comedies","Documentaries","Dramas","Children","Documentaries","Documentaries","Documentaries","Satires"]

main = do
    --(tags1, contents1) <- readAll "funcional"
    --(tags2, contents2) <- readAll "imperativo"
    -- (tagsUnk, contentsUnk) <- readAll "alumnos"
    print $ "Titulos de peliculas: " ++ (show $ length titles) ++ " instancias"
    print $ "Generos: " ++ (show $ length (nub genres))
    let x = titles
    let y = genres
    shuffled <- shuffle (zip x y)
    let (x_shuffled, y_shuffled) = unzip shuffled
    print $ tryClassifier x_shuffled y_shuffled
    -- print $ tryClassifierUnk x_shuffled y_shuffled contentsUnk
    let length_class_1 = genericLength (filter (\x -> x == (head y)) y)
    let random_acc = length_class_1 / (genericLength y)
    print $ "random value: " ++ show random_acc
